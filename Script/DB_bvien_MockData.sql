/*==============================================================*/
/* DBMS name:      ORACLE Version 11g                           */
/* Created on:     8/24/2020 2:02:30 PM                         */
/*==============================================================*/
-- USER + DB DANH CHO PHAN HE 1
CONN SYS/1231 AS SYSDBA;

BEGIN
    EXECUTE IMMEDIATE 'DROP USER DBA_BV01 CASCADE';
    EXECUTE IMMEDIATE 'DROP USER XX CASCADE';
    EXCEPTION WHEN OTHERS THEN NULL; 
END;
/

CREATE USER DBA_BV01 IDENTIFIED BY "1";
CREATE USER XX IDENTIFIED BY "1231";

GRANT ALL PRIVILEGES TO DBA_BV01, XX;
GRANT DBA TO DBA_BV01;

ALTER USER XX ACCOUNT LOCK;

CONN DBA_BV01/1;

/*==============================================================*/
/* DBMS name:      ORACLE Version 11g                           */
/* Created on:     8/28/2020 1:39:09 PM                         */
/*==============================================================*/
BEGIN
    EXECUTE IMMEDIATE 'DROP TABLE BENHNHAN CASCADE CONSTRAINTS';
    EXECUTE IMMEDIATE 'DROP TABLE CHAMCONG CASCADE CONSTRAINTS';
    EXECUTE IMMEDIATE 'DROP TABLE CHITIETDICHVUHD CASCADE CONSTRAINTS';
    EXECUTE IMMEDIATE 'DROP TABLE CHITIETTHUOCHD CASCADE CONSTRAINTS';
    EXECUTE IMMEDIATE 'DROP TABLE CUOCHOP CASCADE CONSTRAINTS';
    EXECUTE IMMEDIATE 'DROP TABLE DICHVU CASCADE CONSTRAINTS';
    EXECUTE IMMEDIATE 'DROP TABLE LUONG CASCADE CONSTRAINTS';
    EXECUTE IMMEDIATE 'DROP TABLE LICHTRUC CASCADE CONSTRAINTS';
    EXECUTE IMMEDIATE 'DROP TABLE NHANVIEN CASCADE CONSTRAINTS';
    EXECUTE IMMEDIATE 'DROP TABLE PHONG CASCADE CONSTRAINTS';
    EXECUTE IMMEDIATE 'DROP TABLE PHONGBAN CASCADE CONSTRAINTS';
    EXECUTE IMMEDIATE 'DROP TABLE THONGTINKHAMBENH CASCADE CONSTRAINTS';
    EXECUTE IMMEDIATE 'DROP TABLE THUOC CASCADE CONSTRAINTS';
    EXCEPTION WHEN OTHERS THEN NULL; 
END;
/

/*==============================================================*/
/* Table: BENHNHAN                                              */
/*==============================================================*/
CREATE TABLE BENHNHAN 
(
   "MABENHNHAN"         INTEGER              NOT NULL,
   "TEN"                VARCHAR2(50),
   "NAMSINH"            INTEGER,
   "DIACHI"             VARCHAR2(50),
   "SODIENTHOAI"        VARCHAR2(50),
   CONSTRAINT PK_BENHNHAN PRIMARY KEY ("MABENHNHAN")
);

/*==============================================================*/
/* Table: "CHAMCONG"                                            */
/*==============================================================*/
CREATE TABLE "CHAMCONG" 
(
   "MACHAMCONG"         INTEGER              NOT NULL,
   "MANV"               INTEGER,
   "BATDAULAM"          DATE,
   "KETTHUC"            DATE,
   CONSTRAINT PK_CHAMCONG PRIMARY KEY ("MACHAMCONG")
);

/*==============================================================*/
/* Table: "CHITIETDICHVUHD"                                     */
/*==============================================================*/
CREATE TABLE "CHITIETDICHVUHD" 
(
   "MACHITIETDICHVU"    INTEGER              NOT NULL,
   "MATHONGTINKHAMBENH" INTEGER,
   "MADICHVU"           INTEGER,
   "MANV"               INTEGER,
   "TENDV"              VARCHAR2(50),
   "SOLAN"              INTEGER,
   "THANHTIEN"          FLOAT,
   "PHONG"              VARCHAR2(50),
   CONSTRAINT PK_CHITIETDICHVUHD PRIMARY KEY ("MACHITIETDICHVU")
);

/*==============================================================*/
/* Table: "CHITIETTHUOCHD"                                      */
/*==============================================================*/
CREATE TABLE "CHITIETTHUOCHD" 
(
   "MACHITIETTHUOC"     INTEGER              NOT NULL,
   "MATHONGTINKHAMBENH" INTEGER,
   "MATHUOC"            INTEGER,
   "SOLUONG"            INTEGER,
   "CACHDUNG"           VARCHAR2(50),
   "THANHTIEN"          FLOAT,
   CONSTRAINT PK_CHITIETTHUOCHD PRIMARY KEY ("MACHITIETTHUOC")
);

/*==============================================================*/
/* Table: "CUOCHOP"                                             */
/*==============================================================*/
CREATE TABLE "CUOCHOP" 
(
   "MACUOCHOP"          INTEGER              NOT NULL,
   "NVCHUTRI"           INTEGER,
   "NOIDUNG"            NVARCHAR2(50),
   CONSTRAINT PK_CUOCHOP PRIMARY KEY ("MACUOCHOP")
);

/*==============================================================*/
/* Table: DICHVU                                                */
/*==============================================================*/
CREATE TABLE DICHVU 
(
   "MADICHVU"           INTEGER              NOT NULL,
   "TENDV"              VARCHAR2(50),
   "LOAIDV"             INTEGER,
   "DONGIA"             FLOAT,
   CONSTRAINT PK_DICHVU PRIMARY KEY ("MADICHVU")
);

/*==============================================================*/
/* Table: LUONG                                                 */
/*==============================================================*/
CREATE TABLE LUONG 
(
   "MALUONG"            INTEGER              NOT NULL,
   "MANV"               INTEGER              NOT NULL,
   "THANG"              INTEGER              NOT NULL,
   "NAM"                INTEGER              NOT NULL,
   "NGAYCONG"           INTEGER,
   "PHUCAP"             FLOAT,
   "TONGLUONG"          FLOAT,
   CONSTRAINT PK_LUONG PRIMARY KEY ("MALUONG")
);

/*==============================================================*/
/* Table: "LICHTRUC"                                            */
/*==============================================================*/
CREATE TABLE "LICHTRUC" 
(
   MALICHTRUC           INTEGER              NOT NULL,
   "MAPHONG"            INTEGER,
   "MANV"               INTEGER,
   NGAY                 DATE,
   CONSTRAINT PK_LICHTRUC PRIMARY KEY (MALICHTRUC)
);

/*==============================================================*/
/* Table: NHANVIEN                                              */
/*==============================================================*/
CREATE TABLE NHANVIEN 
(
   "MANV"               INTEGER              NOT NULL,
   "MAPHONGBAN"         INTEGER,
   "TENNV"              VARCHAR2(50),
   "LOAINV"             VARCHAR2(50),
   "LUONGCB"            FLOAT,
   USERNAME             VARCHAR2(50),
   PASSWORD             VARCHAR2(50),
   CONSTRAINT PK_NHANVIEN PRIMARY KEY ("MANV")
);

/*==============================================================*/
/* Table: PHONG                                                 */
/*==============================================================*/
CREATE TABLE PHONG 
(
   "MAPHONG"            INTEGER              NOT NULL,
   "TINHTRANG"          VARCHAR2(50),
   CONSTRAINT PK_PHONG PRIMARY KEY ("MAPHONG")
);

/*==============================================================*/
/* Table: "PHONGBAN"                                            */
/*==============================================================*/
CREATE TABLE "PHONGBAN" 
(
   "MAPHONGBAN"         INTEGER              NOT NULL,
   "TENPHONGBAN"        NVARCHAR2(50),
   CONSTRAINT PK_PHONGBAN PRIMARY KEY ("MAPHONGBAN")
);

/*==============================================================*/
/* Table: THONGTINKHAMBENH                                      */
/*==============================================================*/
CREATE TABLE THONGTINKHAMBENH 
(
   "MATHONGTINKHAMBENH" INTEGER              NOT NULL,
   "MABENHNHAN"         INTEGER,
   "BACSI"              INTEGER,
   "NGAYKHAM"           DATE,
   "TRIEUCHUNG"         VARCHAR2(50),
   "LOIDAN"             VARCHAR2(50),
   CONSTRAINT PK_THONGTINKHAMBENH PRIMARY KEY ("MATHONGTINKHAMBENH")
);

/*==============================================================*/
/* Table: THUOC                                                 */
/*==============================================================*/
CREATE TABLE THUOC 
(
   "MATHUOC"            INTEGER              NOT NULL,
   "TENTHUOC"           VARCHAR2(50),
   "DONGIA"             FLOAT,
   "TONKHO"             INTEGER,
   CONSTRAINT PK_THUOC PRIMARY KEY ("MATHUOC")
);

ALTER TABLE "CHAMCONG"
   ADD CONSTRAINT FK_CHAMCONG_REFERENCE_NHANVIEN FOREIGN KEY ("MANV")
      REFERENCES NHANVIEN ("MANV");

ALTER TABLE "CHITIETDICHVUHD"
   ADD CONSTRAINT FK_CHITIETD_REFERENCE_THONGTIN FOREIGN KEY ("MATHONGTINKHAMBENH")
      REFERENCES THONGTINKHAMBENH ("MATHONGTINKHAMBENH");

ALTER TABLE "CHITIETDICHVUHD"
   ADD CONSTRAINT FK_CHITIETD_REFERENCE_DICHVU FOREIGN KEY ("MADICHVU")
      REFERENCES DICHVU ("MADICHVU");

ALTER TABLE "CHITIETDICHVUHD"
   ADD CONSTRAINT FK_CHITIETD_REFERENCE_NHANVIEN FOREIGN KEY ("MANV")
      REFERENCES NHANVIEN ("MANV");

ALTER TABLE "CHITIETTHUOCHD"
   ADD CONSTRAINT FK_CHITIETT_REFERENCE_THONGTIN FOREIGN KEY ("MATHONGTINKHAMBENH")
      REFERENCES THONGTINKHAMBENH ("MATHONGTINKHAMBENH");

ALTER TABLE "CHITIETTHUOCHD"
   ADD CONSTRAINT FK_CHITIETT_REFERENCE_THUOC FOREIGN KEY ("MATHUOC")
      REFERENCES THUOC ("MATHUOC");

ALTER TABLE "CUOCHOP"
   ADD CONSTRAINT FK_CUOCHOP_REFERENCE_NHANVIEN FOREIGN KEY ("NVCHUTRI")
      REFERENCES NHANVIEN ("MANV");

ALTER TABLE LUONG
   ADD CONSTRAINT FK_LUONG_REFERENCE_NHANVIEN FOREIGN KEY ("MANV")
      REFERENCES NHANVIEN ("MANV");

ALTER TABLE "LICHTRUC"
   ADD CONSTRAINT FK_LICHTRUC_REFERENCE_PHONG FOREIGN KEY ("MAPHONG")
      REFERENCES PHONG ("MAPHONG");

ALTER TABLE "LICHTRUC"
   ADD CONSTRAINT FK_LICHTRUC_REFERENCE_NHANVIEN FOREIGN KEY ("MANV")
      REFERENCES NHANVIEN ("MANV");

ALTER TABLE NHANVIEN
   ADD CONSTRAINT FK_NHANVIEN_REFERENCE_PHONGBAN FOREIGN KEY ("MAPHONGBAN")
      REFERENCES "PHONGBAN" ("MAPHONGBAN");

ALTER TABLE THONGTINKHAMBENH
   ADD CONSTRAINT FK_THONGTIN_REFERENCE_BENHNHAN FOREIGN KEY ("MABENHNHAN")
      REFERENCES BENHNHAN ("MABENHNHAN");

ALTER TABLE THONGTINKHAMBENH
   ADD CONSTRAINT FK_THONGTIN_REFERENCE_NHANVIEN FOREIGN KEY ("BACSI")
      REFERENCES NHANVIEN ("MANV");


--ADD MOCK DB

DELETE FROM CHITIETDICHVUHD;

DELETE FROM CHITIETTHUOCHD;

DELETE FROM CHAMCONG;

DELETE FROM THONGTINKHAMBENH;

DELETE FROM CUOCHOP;

DELETE FROM LICHTRUC;

DELETE FROM PHONG;

DELETE FROM PHONGBAN;

DELETE FROM LUONG;

DELETE FROM THUOC;

DELETE FROM DICHVU;

DELETE FROM NHANVIEN;

DELETE FROM BENHNHAN;

/*==============================================================*/
/* Generate test data for the table "BENHNHAN".                 */
/*==============================================================*/
INSERT INTO BENHNHAN ("MABENHNHAN", "TEN", "NAMSINH", "DIACHI", "SODIENTHOAI") VALUES (0, 'NGUYEN VAN A', 1999, '71/22 T.D.T', '914939495');

INSERT INTO BENHNHAN ("MABENHNHAN", "TEN", "NAMSINH", "DIACHI", "SODIENTHOAI") VALUES (1, 'NGUYEN VAN B', 1993, ' 21/12 C.T.D', '992939412');

INSERT INTO BENHNHAN ("MABENHNHAN", "TEN", "NAMSINH", "DIACHI", "SODIENTHOAI") VALUES (2, 'NGUYEN VAN C', 1998, ' 51/22/3 N.V.D', '984727384');

INSERT INTO BENHNHAN ("MABENHNHAN", "TEN", "NAMSINH", "DIACHI", "SODIENTHOAI") VALUES (3, 'NGUYEN VAN D', 1995, '71/22/4 P.Q.D', '954875622');

INSERT INTO BENHNHAN ("MABENHNHAN", "TEN", "NAMSINH", "DIACHI", "SODIENTHOAI") VALUES (4, 'NGUYEN VAN E', 1997, '71/2/3/3 P.A.D', '909998273');

INSERT INTO BENHNHAN ("MABENHNHAN", "TEN", "NAMSINH", "DIACHI", "SODIENTHOAI") VALUES (5, 'NGUYEN VAN F', 1991, '71/22/2 P.V.W', '747582857');

INSERT INTO BENHNHAN ("MABENHNHAN", "TEN", "NAMSINH", "DIACHI", "SODIENTHOAI") VALUES (6, 'NGUYEN VAN G', 1994, '71/22/6 P.V.D', '919293949');

INSERT INTO BENHNHAN ("MABENHNHAN", "TEN", "NAMSINH", "DIACHI", "SODIENTHOAI") VALUES (7, 'NGUYEN VAN H', 1986, '71/22/8 P.V.V', '55521583');

INSERT INTO BENHNHAN ("MABENHNHAN", "TEN", "NAMSINH", "DIACHI", "SODIENTHOAI") VALUES (8, 'NGUYEN VAN I', 1990, '71/22/20 P.V.A', '700293485');

INSERT INTO BENHNHAN ("MABENHNHAN", "TEN", "NAMSINH", "DIACHI", "SODIENTHOAI") VALUES (9, 'NGUYEN VAN K', 1962, '71/22/6 P.V.D', '948756351');

/*==============================================================*/
/* Generate test data for the table "PHONG BAN".                */
/*==============================================================*/
INSERT INTO "PHONGBAN" ("MAPHONGBAN", "TENPHONGBAN") VALUES (1, 'PHONG QUAN LY');

INSERT INTO "PHONGBAN" ("MAPHONGBAN", "TENPHONGBAN") VALUES (2, 'PHONG TIEP TAN');

INSERT INTO "PHONGBAN" ("MAPHONGBAN", "TENPHONGBAN") VALUES (3, 'PHONG TAI VU');

INSERT INTO "PHONGBAN" ("MAPHONGBAN", "TENPHONGBAN") VALUES (4, 'PHONG BAC SI');

INSERT INTO "PHONGBAN" ("MAPHONGBAN", "TENPHONGBAN") VALUES (5, 'PHONG BAN THUOC');

INSERT INTO "PHONGBAN" ("MAPHONGBAN", "TENPHONGBAN") VALUES (6, 'PHONG KE TOAN');

/*==============================================================*/
/* Generate test data for the table "NHANVIEN".                 */
/*==============================================================*/
INSERT INTO NHANVIEN ("MANV", "MAPHONGBAN", "TENNV", "LOAINV", "LUONGCB", USERNAME, PASSWORD) VALUES (0, 1, 'BUI NGOC K V', 'QUAN LY', 50000, 'QL001', '1');

INSERT INTO NHANVIEN ("MANV", "MAPHONGBAN", "TENNV", "LOAINV", "LUONGCB", USERNAME, PASSWORD) VALUES (1, 1, 'BUI NGOC A K', 'QUAN LY', 90000, 'QL002', '1');

INSERT INTO NHANVIEN ("MANV", "MAPHONGBAN", "TENNV", "LOAINV", "LUONGCB", USERNAME, PASSWORD) VALUES (2, 2, 'BUI NGOC Y N', 'QUAN LY', 20000, 'QL003', '1');

INSERT INTO NHANVIEN ("MANV", "MAPHONGBAN", "TENNV", "LOAINV", "LUONGCB", USERNAME, PASSWORD) VALUES (3, 2, 'BUI NGOC A X', 'TAI VU', 40000, 'TV001', '1');

INSERT INTO NHANVIEN ("MANV", "MAPHONGBAN", "TENNV", "LOAINV", "LUONGCB", USERNAME, PASSWORD) VALUES (4, 3, 'BUI NGOC D K', 'KE TOAN', 60000, 'KT001', '1');

INSERT INTO NHANVIEN ("MANV", "MAPHONGBAN", "TENNV", "LOAINV", "LUONGCB", USERNAME, PASSWORD) VALUES (5, 3, 'BUI NGOC H Y', 'TIEP TAN', 80000, 'TT001', '1');

INSERT INTO NHANVIEN ("MANV", "MAPHONGBAN", "TENNV", "LOAINV", "LUONGCB", USERNAME, PASSWORD) VALUES (6, 4, 'BUI NGOC L Q', 'TIEP TAN', 7000, 'TT002', '1');

INSERT INTO NHANVIEN ("MANV", "MAPHONGBAN", "TENNV", "LOAINV", "LUONGCB", USERNAME, PASSWORD) VALUES (7, 4, 'BUI NGOC T V', 'BAC SI', 30000, 'BS001', '1');

INSERT INTO NHANVIEN ("MANV", "MAPHONGBAN", "TENNV", "LOAINV", "LUONGCB", USERNAME, PASSWORD) VALUES (8, 5, 'BUI NGOC Q A', 'BAC SI', 100000, 'BS002', '1');

INSERT INTO NHANVIEN ("MANV", "MAPHONGBAN", "TENNV", "LOAINV", "LUONGCB", USERNAME, PASSWORD) VALUES (9, 5, 'BUI NGOC P P', 'BAN THUOC', 10000, 'BT001', '1');

/*==============================================================*/
/* Generate test data for the table "CHAMCONG".                 */
/*==============================================================*/
INSERT INTO CHAMCONG("MACHAMCONG","MANV","BATDAULAM","KETTHUC") VALUES (0,1,TO_DATE('2003/05/03 7:05:44', 'yyyy/mm/dd hh24:mi:ss'),TO_DATE('2003/05/03 17:05:44', 'yyyy/mm/dd hh24:mi:ss'));
INSERT INTO CHAMCONG("MACHAMCONG","MANV","BATDAULAM","KETTHUC") VALUES (1,2,TO_DATE('2003/05/03 7:02:44', 'yyyy/mm/dd hh24:mi:ss'),TO_DATE('2003/05/03 15:02:44', 'yyyy/mm/dd hh24:mi:ss'));
INSERT INTO CHAMCONG("MACHAMCONG","MANV","BATDAULAM","KETTHUC") VALUES (2,3,TO_DATE('2003/05/03 13:02:44', 'yyyy/mm/dd hh24:mi:ss'),TO_DATE('2003/05/03 17:02:44', 'yyyy/mm/dd hh24:mi:ss'));
INSERT INTO CHAMCONG("MACHAMCONG","MANV","BATDAULAM","KETTHUC") VALUES (3,4,TO_DATE('2003/05/03 7:02:44', 'yyyy/mm/dd hh24:mi:ss'),TO_DATE('2003/05/03 17:07:44', 'yyyy/mm/dd hh24:mi:ss'));
INSERT INTO CHAMCONG("MACHAMCONG","MANV","BATDAULAM","KETTHUC") VALUES (4,5,TO_DATE('2003/05/03 8:02:44', 'yyyy/mm/dd hh24:mi:ss'),TO_DATE('2003/05/03 17:02:44', 'yyyy/mm/dd hh24:mi:ss'));
INSERT INTO CHAMCONG("MACHAMCONG","MANV","BATDAULAM","KETTHUC") VALUES (5,1,TO_DATE('2003/05/03 21:02:44', 'yyyy/mm/dd hh24:mi:ss'),TO_DATE('2003/05/03 18:02:44', 'yyyy/mm/dd hh24:mi:ss'));
INSERT INTO CHAMCONG("MACHAMCONG","MANV","BATDAULAM","KETTHUC") VALUES (6,6,TO_DATE('2003/05/03 11:02:44', 'yyyy/mm/dd hh24:mi:ss'),TO_DATE('2003/05/03 17:09:44', 'yyyy/mm/dd hh24:mi:ss'));
INSERT INTO CHAMCONG("MACHAMCONG","MANV","BATDAULAM","KETTHUC") VALUES (7,8,TO_DATE('2003/05/03 2:02:44', 'yyyy/mm/dd hh24:mi:ss'),TO_DATE('2003/05/03 16:02:44', 'yyyy/mm/dd hh24:mi:ss'));
INSERT INTO CHAMCONG("MACHAMCONG","MANV","BATDAULAM","KETTHUC") VALUES (8,9,TO_DATE('2003/05/03 7:09:44', 'yyyy/mm/dd hh24:mi:ss'),TO_DATE('2003/05/03 16:08:44', 'yyyy/mm/dd hh24:mi:ss'));
INSERT INTO CHAMCONG("MACHAMCONG","MANV","BATDAULAM","KETTHUC") VALUES (9,2,TO_DATE('2003/05/03 8:02:44', 'yyyy/mm/dd hh24:mi:ss'),TO_DATE('2003/05/03 17:01:44', 'yyyy/mm/dd hh24:mi:ss'));
INSERT INTO CHAMCONG("MACHAMCONG","MANV","BATDAULAM","KETTHUC") VALUES (10,1,TO_DATE('2003/05/03 1:06:44', 'yyyy/mm/dd hh24:mi:ss'),TO_DATE('2003/05/03 16:04:44', 'yyyy/mm/dd hh24:mi:ss'));

/*==============================================================*/
/* Generate test data for the table "DICHVU".                   */
/*==============================================================*/
INSERT INTO DICHVU ("MADICHVU", "TENDV", "DONGIA") VALUES (0, 'CHUP X-QUANG', 500000);

INSERT INTO DICHVU ("MADICHVU", "TENDV", "DONGIA") VALUES (1, 'SIEU AM', 600000);

INSERT INTO DICHVU ("MADICHVU", "TENDV", "DONGIA") VALUES (2, 'KHAM SUC KHOE TONG QUAT', 40000);

INSERT INTO DICHVU ("MADICHVU", "TENDV", "DONGIA") VALUES (3, 'KHAM SUC KHOE BANG LAI XE', 30000);

INSERT INTO DICHVU ("MADICHVU", "TENDV", "DONGIA") VALUES (4, 'NOI SOI', 100000);

INSERT INTO DICHVU ("MADICHVU", "TENDV", "DONGIA") VALUES (5, 'HUT THAI', 500000);

INSERT INTO DICHVU ("MADICHVU", "TENDV", "DONGIA") VALUES (6, 'XET NGHIEM MAU', 200000);

INSERT INTO DICHVU ("MADICHVU", "TENDV", "DONGIA") VALUES (7, 'XET NGHIEM ADN', 800000);

INSERT INTO DICHVU ("MADICHVU", "TENDV", "DONGIA") VALUES (8, 'KHAM THAI', 800000);

INSERT INTO DICHVU ("MADICHVU", "TENDV", "DONGIA") VALUES (9, 'CHAM SOC DAC BIET', 600000);

/*==============================================================*/
/* Generate test data for the table "THUOC".                    */
/*==============================================================*/
INSERT INTO THUOC ("MATHUOC", "TENTHUOC", "DONGIA", "TONKHO") VALUES (0, 'Gynofar 5V', 50000, 20);

INSERT INTO THUOC ("MATHUOC", "TENTHUOC", "DONGIA", "TONKHO") VALUES (1, 'Motilium-M', 46000, 30);

INSERT INTO THUOC ("MATHUOC", "TENTHUOC", "DONGIA", "TONKHO") VALUES (2, 'Misenbo', 20000, 10);

INSERT INTO THUOC ("MATHUOC", "TENTHUOC", "DONGIA", "TONKHO") VALUES (3, 'Lucrin PDS', 25000, 40);

INSERT INTO THUOC ("MATHUOC", "TENTHUOC", "DONGIA", "TONKHO") VALUES (4, 'Mifepristone', 30000, 70);

INSERT INTO THUOC ("MATHUOC", "TENTHUOC", "DONGIA", "TONKHO") VALUES (5, 'Hapacol 250', 70000, 90);

INSERT INTO THUOC ("MATHUOC", "TENTHUOC", "DONGIA", "TONKHO") VALUES (6, 'Glucacel L', 82000, 60);

INSERT INTO THUOC ("MATHUOC", "TENTHUOC", "DONGIA", "TONKHO") VALUES (7, 'Esonix 40mg', 6000, 80);

INSERT INTO THUOC ("MATHUOC", "TENTHUOC", "DONGIA", "TONKHO") VALUES (8, 'Efferalgan', 1000, 500);

INSERT INTO THUOC ("MATHUOC", "TENTHUOC", "DONGIA", "TONKHO") VALUES (9, 'Actoramin', 30000, 10);

/*==============================================================*/
/* Generate test data for the table "LUONG".                    */
/*==============================================================*/
INSERT INTO LUONG ("MALUONG", "MANV", "THANG", "NAM", "NGAYCONG", "PHUCAP", "TONGLUONG") VALUES (0, 9, 1, 2020, 20, 70000, 300000);

INSERT INTO LUONG ("MALUONG", "MANV", "THANG", "NAM", "NGAYCONG", "PHUCAP", "TONGLUONG") VALUES (1, 8, 1, 2020, 20, 50000, 200000);

INSERT INTO LUONG ("MALUONG", "MANV", "THANG", "NAM", "NGAYCONG", "PHUCAP", "TONGLUONG") VALUES (2, 7, 1, 2020, 20, 40000, 900000);

INSERT INTO LUONG ("MALUONG", "MANV", "THANG", "NAM", "NGAYCONG", "PHUCAP", "TONGLUONG") VALUES (3, 6, 1, 2020, 20, 80000, 5000000);

INSERT INTO LUONG ("MALUONG", "MANV", "THANG", "NAM", "NGAYCONG", "PHUCAP", "TONGLUONG") VALUES (4, 5, 1, 2020, 20, 50000, 1000000);

INSERT INTO LUONG ("MALUONG", "MANV", "THANG", "NAM", "NGAYCONG", "PHUCAP", "TONGLUONG") VALUES (5, 4, 1, 2020, 29, 30000, 7000000);

INSERT INTO LUONG ("MALUONG", "MANV", "THANG", "NAM", "NGAYCONG", "PHUCAP", "TONGLUONG") VALUES (6, 3, 1, 2020, 27, 20000, 6000000);

INSERT INTO LUONG ("MALUONG", "MANV", "THANG", "NAM", "NGAYCONG", "PHUCAP", "TONGLUONG") VALUES (7, 2, 1, 2020, 25, 90000, 8000000);

INSERT INTO LUONG ("MALUONG", "MANV", "THANG", "NAM", "NGAYCONG", "PHUCAP", "TONGLUONG") VALUES (8, 1, 1, 2020, 20, 60000, 30000000);

INSERT INTO LUONG ("MALUONG", "MANV", "THANG", "NAM", "NGAYCONG", "PHUCAP", "TONGLUONG") VALUES (9, 0, 1, 2020, 15, 10000, 2400000);

/*==============================================================*/
/* Generate test data for the table "PHONG".                    */
/*==============================================================*/
INSERT INTO PHONG ("MAPHONG", "TINHTRANG") VALUES (0, 'DANG SU DUNG');

INSERT INTO PHONG ("MAPHONG", "TINHTRANG") VALUES (1, 'DANG SU DUNG');

INSERT INTO PHONG ("MAPHONG", "TINHTRANG") VALUES (2, 'DANG SU DUNG');

INSERT INTO PHONG ("MAPHONG", "TINHTRANG") VALUES (3, 'DANG SU DUNG');

INSERT INTO PHONG ("MAPHONG", "TINHTRANG") VALUES (4, 'DANG SU DUNG');

INSERT INTO PHONG ("MAPHONG", "TINHTRANG") VALUES (5, 'DANG SU DUNG');

INSERT INTO PHONG ("MAPHONG", "TINHTRANG") VALUES (6, 'DANG SU DUNG');

INSERT INTO PHONG ("MAPHONG", "TINHTRANG") VALUES (7, 'DANG SU DUNG');

INSERT INTO PHONG ("MAPHONG", "TINHTRANG") VALUES (8, 'DANG SU DUNG');

INSERT INTO PHONG ("MAPHONG", "TINHTRANG") VALUES (9, 'DANG SU DUNG');

/*==============================================================*/
/* Generate test data for the table "LICH TRUC".                */
/*==============================================================*/
ALTER SESSION SET NLS_DATE_FORMAT='YYYY-MM-DD';

INSERT INTO "LICHTRUC" (MALICHTRUC, "MAPHONG", "MANV", NGAY) VALUES (0, 5, 9, '2000-11-10');

INSERT INTO "LICHTRUC" (MALICHTRUC, "MAPHONG", "MANV", NGAY) VALUES (1, 5, 9, '2000-11-2');

INSERT INTO "LICHTRUC" (MALICHTRUC, "MAPHONG", "MANV", NGAY) VALUES (2, 0, 0, '2000-11-7');

INSERT INTO "LICHTRUC" (MALICHTRUC, "MAPHONG", "MANV", NGAY) VALUES (3, 3, 0, '2000-1-1');

INSERT INTO "LICHTRUC" (MALICHTRUC, "MAPHONG", "MANV", NGAY) VALUES (4, 7, 1, '2000-11-10');

INSERT INTO "LICHTRUC" (MALICHTRUC, "MAPHONG", "MANV", NGAY) VALUES (5, 9, 4, '2000-9-11');

INSERT INTO "LICHTRUC" (MALICHTRUC, "MAPHONG", "MANV", NGAY) VALUES (6, 8, 1, '2000-7-21');

INSERT INTO "LICHTRUC" (MALICHTRUC, "MAPHONG", "MANV", NGAY) VALUES (7, 8, 6, '2000-7-19');

INSERT INTO "LICHTRUC" (MALICHTRUC, "MAPHONG", "MANV", NGAY) VALUES (8, 5, 2, '2000-12-8');

INSERT INTO "LICHTRUC" (MALICHTRUC, "MAPHONG", "MANV", NGAY) VALUES (9, 6, 6, '2000-3-22');

/*==============================================================*/
/* Generate test data for the table "CUOC HOP".                 */
/*==============================================================*/
INSERT INTO "CUOCHOP" ("MACUOCHOP", "NVCHUTRI", "NOIDUNG") VALUES (0, 0, 'THAY DOI QUY CHE TINH LUONG');

INSERT INTO "CUOCHOP" ("MACUOCHOP", "NVCHUTRI", "NOIDUNG") VALUES (1, 1, 'THAY DOI QUY TRINH KHAM CHUA BENH');

INSERT INTO "CUOCHOP" ("MACUOCHOP", "NVCHUTRI", "NOIDUNG") VALUES (2, 2, 'HOP MAT RIENG');

INSERT INTO "CUOCHOP" ("MACUOCHOP", "NVCHUTRI", "NOIDUNG") VALUES (3, 0, 'TRIEN KHAI PHUONG PHAP KHAM CHUA BENH MOI');

INSERT INTO "CUOCHOP" ("MACUOCHOP", "NVCHUTRI", "NOIDUNG") VALUES (4, 1, 'VE SINH NOI LAM VIEC');

INSERT INTO "CUOCHOP" ("MACUOCHOP", "NVCHUTRI", "NOIDUNG") VALUES (5, 3, 'TIET KIEM DIEN');

INSERT INTO "CUOCHOP" ("MACUOCHOP", "NVCHUTRI", "NOIDUNG") VALUES (6, 4, 'VAN HANH BENH VIEN');

INSERT INTO "CUOCHOP" ("MACUOCHOP", "NVCHUTRI", "NOIDUNG") VALUES (7, 5, 'CHUYEN GIAO CONG NGHE MOI');

INSERT INTO "CUOCHOP" ("MACUOCHOP", "NVCHUTRI", "NOIDUNG") VALUES (8, 6, 'THI NGHIEM TREN DONG VAT');

INSERT INTO "CUOCHOP" ("MACUOCHOP", "NVCHUTRI", "NOIDUNG") VALUES (9, 9, 'THI NGHIEM TREN CON NGUOI');

/*==============================================================*/
/* Generate test data for the table "THONGTINKHAMBENH".         */
/*==============================================================*/
INSERT INTO THONGTINKHAMBENH ("MATHONGTINKHAMBENH", "MABENHNHAN", "BACSI", "NGAYKHAM", "TRIEUCHUNG", "LOIDAN") VALUES (0, 3, 7, '2000-10-31', 'DAU BUNG', 'UONG THUOC DFQAA');

INSERT INTO THONGTINKHAMBENH ("MATHONGTINKHAMBENH", "MABENHNHAN", "BACSI", "NGAYKHAM", "TRIEUCHUNG", "LOIDAN") VALUES (1, 2, 6, '2000-1-1', 'NHUC DAU', 'LUYEN TAP NHIEU');

INSERT INTO THONGTINKHAMBENH ("MATHONGTINKHAMBENH", "MABENHNHAN", "BACSI", "NGAYKHAM", "TRIEUCHUNG", "LOIDAN") VALUES (2, 8, 6, '2000-8-28', 'CHONG MAT', 'HAN CHE DI LAI');

INSERT INTO THONGTINKHAMBENH ("MATHONGTINKHAMBENH", "MABENHNHAN", "BACSI", "NGAYKHAM", "TRIEUCHUNG", "LOIDAN") VALUES (3, 2, 7, '2000-2-12', 'BUON NON', 'UONG NHIEU NUOC');

INSERT INTO THONGTINKHAMBENH ("MATHONGTINKHAMBENH", "MABENHNHAN", "BACSI", "NGAYKHAM", "TRIEUCHUNG", "LOIDAN") VALUES (4, 1, 6, '2000-8-31', 'NGU KHONG NGON', 'HAN CHE UONG RUOU BIA');

INSERT INTO THONGTINKHAMBENH ("MATHONGTINKHAMBENH", "MABENHNHAN", "BACSI", "NGAYKHAM", "TRIEUCHUNG", "LOIDAN") VALUES (5, 7, 7, '2000-1-7', 'GAY XUONG', 'HAN CHE DI LAI');

INSERT INTO THONGTINKHAMBENH ("MATHONGTINKHAMBENH", "MABENHNHAN", "BACSI", "NGAYKHAM", "TRIEUCHUNG", "LOIDAN") VALUES (6, 2, 6, '2000-3-14', 'THIEU MAU', 'KHONG AN THUC AN QUA CUNG');

INSERT INTO THONGTINKHAMBENH ("MATHONGTINKHAMBENH", "MABENHNHAN", "BACSI", "NGAYKHAM", "TRIEUCHUNG", "LOIDAN") VALUES (7, 2, 7, '2000-12-25', 'MAT NGU', 'LUYEN TAP THE THAO DIEU DO');

INSERT INTO THONGTINKHAMBENH ("MATHONGTINKHAMBENH", "MABENHNHAN", "BACSI", "NGAYKHAM", "TRIEUCHUNG", "LOIDAN") VALUES (8, 9, 6, '2000-4-19', 'TE CHAN TAY', 'VAN DONG NHIEU');

INSERT INTO THONGTINKHAMBENH ("MATHONGTINKHAMBENH", "MABENHNHAN", "BACSI", "NGAYKHAM", "TRIEUCHUNG", "LOIDAN") VALUES (9, 5, 6, '2000-4-23', 'DAU BUNG AM I', 'HAN CHE AN DAU MO');

/*==============================================================*/
/* Generate test data for the table "CHITIETTHUOC_HD".          */
/*==============================================================*/
INSERT INTO "CHITIETTHUOCHD" ("MACHITIETTHUOC", "MATHONGTINKHAMBENH", "MATHUOC", "SOLUONG", "CACHDUNG", "THANHTIEN") VALUES (0, 6, 9, 6, 'NGAY 5 LAN, MOI LAN 1 VIEN', 60000);

INSERT INTO "CHITIETTHUOCHD" ("MACHITIETTHUOC", "MATHONGTINKHAMBENH", "MATHUOC", "SOLUONG", "CACHDUNG", "THANHTIEN") VALUES (3, 3, 3, 7, 'NGAY 5 LAN, MOI LAN 1 VIEN', 40000);

INSERT INTO "CHITIETTHUOCHD" ("MACHITIETTHUOC", "MATHONGTINKHAMBENH", "MATHUOC", "SOLUONG", "CACHDUNG", "THANHTIEN") VALUES (8, 3, 3, 4, 'NGAY 5 LAN, MOI LAN 1 VIEN', 50000);

INSERT INTO "CHITIETTHUOCHD" ("MACHITIETTHUOC", "MATHONGTINKHAMBENH", "MATHUOC", "SOLUONG", "CACHDUNG", "THANHTIEN") VALUES (2, 9, 9, 9, 'NGAY 5 LAN, MOI LAN 1 VIEN', 70000);

INSERT INTO "CHITIETTHUOCHD" ("MACHITIETTHUOC", "MATHONGTINKHAMBENH", "MATHUOC", "SOLUONG", "CACHDUNG", "THANHTIEN") VALUES (6, 0, 2, 0, 'NGAY 5 LAN, MOI LAN 1 VIEN', 90000);

INSERT INTO "CHITIETTHUOCHD" ("MACHITIETTHUOC", "MATHONGTINKHAMBENH", "MATHUOC", "SOLUONG", "CACHDUNG", "THANHTIEN") VALUES (1, 0, 0, 3, 'NGAY 5 LAN, MOI LAN 1 VIEN', 30000);

INSERT INTO "CHITIETTHUOCHD" ("MACHITIETTHUOC", "MATHONGTINKHAMBENH", "MATHUOC", "SOLUONG", "CACHDUNG", "THANHTIEN") VALUES (5, 7, 9, 5, 'NGAY 5 LAN, MOI LAN 1 VIEN', 20000);

INSERT INTO "CHITIETTHUOCHD" ("MACHITIETTHUOC", "MATHONGTINKHAMBENH", "MATHUOC", "SOLUONG", "CACHDUNG", "THANHTIEN") VALUES (9, 9, 4, 2, 'NGAY 5 LAN, MOI LAN 1 VIEN', 90000);

INSERT INTO "CHITIETTHUOCHD" ("MACHITIETTHUOC", "MATHONGTINKHAMBENH", "MATHUOC", "SOLUONG", "CACHDUNG", "THANHTIEN") VALUES (7, 0, 6, 8, 'NGAY 5 LAN, MOI LAN 1 VIEN', 80000);

INSERT INTO "CHITIETTHUOCHD" ("MACHITIETTHUOC", "MATHONGTINKHAMBENH", "MATHUOC", "SOLUONG", "CACHDUNG", "THANHTIEN") VALUES (4, 1, 1, 1, 'NGAY 5 LAN, MOI LAN 1 VIEN', 10000);

/*==============================================================*/
/* Generate test data for the table "CHITIETDICHVU_HD".         */
/*==============================================================*/
INSERT INTO "CHITIETDICHVUHD" ("MACHITIETDICHVU", "MATHONGTINKHAMBENH", "MADICHVU", "MANV", "TENDV", "SOLAN", "THANHTIEN", "PHONG") VALUES (3, 3, 6, 7, '5TD4LL40VM', 5, 900000, 'PHONG 1 - BS. A');

INSERT INTO "CHITIETDICHVUHD" ("MACHITIETDICHVU", "MATHONGTINKHAMBENH", "MADICHVU", "MANV", "TENDV", "SOLAN", "THANHTIEN", "PHONG") VALUES (4, 0, 4, 0, 'IG6225IB5L', 8, 89000000, 'PHONG 2 - BS. A');

INSERT INTO "CHITIETDICHVUHD" ("MACHITIETDICHVU", "MATHONGTINKHAMBENH", "MADICHVU", "MANV", "TENDV", "SOLAN", "THANHTIEN", "PHONG") VALUES (9, 1, 0, 4, 'F0D FNO1TQ', 6, 30000000, 'PHONG 3 - BS. A');

INSERT INTO "CHITIETDICHVUHD" ("MACHITIETDICHVU", "MATHONGTINKHAMBENH", "MADICHVU", "MANV", "TENDV", "SOLAN", "THANHTIEN", "PHONG") VALUES (6, 0, 7, 7, 'WBNCGG7LR5', 7, 89000000, 'PHONG 1 - BS. A');

INSERT INTO "CHITIETDICHVUHD" ("MACHITIETDICHVU", "MATHONGTINKHAMBENH", "MADICHVU", "MANV", "TENDV", "SOLAN", "THANHTIEN", "PHONG") VALUES (7, 6, 0, 2, '79SXJR9VFN', 3, 35200000, 'PHONG 2 - BS. A');

INSERT INTO "CHITIETDICHVUHD" ("MACHITIETDICHVU", "MATHONGTINKHAMBENH", "MADICHVU", "MANV", "TENDV", "SOLAN", "THANHTIEN", "PHONG") VALUES (1, 4, 3, 5, 'KOB3SO3WUQ', 4, 520000, 'PHONG 1 - BS. B');

INSERT INTO "CHITIETDICHVUHD" ("MACHITIETDICHVU", "MATHONGTINKHAMBENH", "MADICHVU", "MANV", "TENDV", "SOLAN", "THANHTIEN", "PHONG") VALUES (8, 9, 0, 9, 'G1GU5EQVMV', 9, 6000000, 'PHONG 2 - BS. A');

INSERT INTO "CHITIETDICHVUHD" ("MACHITIETDICHVU", "MATHONGTINKHAMBENH", "MADICHVU", "MANV", "TENDV", "SOLAN", "THANHTIEN", "PHONG") VALUES (2, 8, 7, 0, ' HJ5D1X4T6', 1, 2700000, 'PHONG 1 - BS. A');

INSERT INTO "CHITIETDICHVUHD" ("MACHITIETDICHVU", "MATHONGTINKHAMBENH", "MADICHVU", "MANV", "TENDV", "SOLAN", "THANHTIEN", "PHONG") VALUES (5, 9, 0, 3, 'V87DN0W86X', 2, 400000, 'PHONG 2 - BS. A');

INSERT INTO "CHITIETDICHVUHD" ("MACHITIETDICHVU", "MATHONGTINKHAMBENH", "MADICHVU", "MANV", "TENDV", "SOLAN", "THANHTIEN", "PHONG") VALUES (0, 8, 8, 9, '2 P6NESFAG', 0, 100000, 'PHONG 4 - BS. B');
/
/

BEGIN
    EXECUTE IMMEDIATE 'DROP ROLE QUAN_LY_TAI_NGUYEN';
    EXECUTE IMMEDIATE 'DROP ROLE QUAN_LY_TAI_VU';
    EXECUTE IMMEDIATE 'DROP ROLE QUAN_LY_CHUYEN_MON';
    EXECUTE IMMEDIATE 'DROP ROLE TIEP_TAN';
    EXECUTE IMMEDIATE 'DROP ROLE TAI_VU';
    EXECUTE IMMEDIATE 'DROP ROLE BAC_SI';
    EXECUTE IMMEDIATE 'DROP ROLE BAN_THUOC';
    EXECUTE IMMEDIATE 'DROP ROLE KE_TOAN';
    EXCEPTION WHEN OTHERS THEN NULL; 
END;
/

SELECT   'GRANT SELECT ON DBA_BV01.' || TABLE_NAME || ' to QUAN_LY_TAI_NGUYEN;'
FROM     DBA_TABLES WHERE OWNER = 'DBA_BV01';
/

CREATE ROLE QUAN_LY_TAI_NGUYEN;
GRANT INSERT, DELETE, UPDATE ON PHONGBAN TO QUAN_LY_TAI_NGUYEN;
GRANT INSERT, DELETE, UPDATE ON NHANVIEN TO QUAN_LY_TAI_NGUYEN;
GRANT INSERT, DELETE, UPDATE ON LICHTRUC TO QUAN_LY_TAI_NGUYEN;
GRANT INSERT, DELETE, UPDATE ON CUOCHOP TO QUAN_LY_TAI_NGUYEN;

GRANT SELECT ON DBA_BV01.BENHNHAN TO QUAN_LY_TAI_NGUYEN;
GRANT SELECT ON DBA_BV01.CHAMCONG TO QUAN_LY_TAI_NGUYEN;
GRANT SELECT ON DBA_BV01.CHITIETDICHVUHD TO QUAN_LY_TAI_NGUYEN;
GRANT SELECT ON DBA_BV01.CHITIETTHUOCHD TO QUAN_LY_TAI_NGUYEN;
GRANT SELECT ON DBA_BV01.DICHVU TO QUAN_LY_TAI_NGUYEN;
GRANT SELECT ON DBA_BV01.LUONG TO QUAN_LY_TAI_NGUYEN;
GRANT SELECT ON DBA_BV01.LICHTRUC TO QUAN_LY_TAI_NGUYEN;
GRANT SELECT ON DBA_BV01.NHANVIEN TO QUAN_LY_TAI_NGUYEN;
GRANT SELECT ON DBA_BV01.PHONG TO QUAN_LY_TAI_NGUYEN;
GRANT SELECT ON DBA_BV01.PHONGBAN TO QUAN_LY_TAI_NGUYEN;
GRANT SELECT ON DBA_BV01.THONGTINKHAMBENH TO QUAN_LY_TAI_NGUYEN;
GRANT SELECT ON DBA_BV01.THUOC TO QUAN_LY_TAI_NGUYEN;
GRANT SELECT ON DBA_BV01.CUOCHOP TO QUAN_LY_TAI_NGUYEN;
/

CREATE ROLE QUAN_LY_TAI_VU;
GRANT INSERT, UPDATE(NGAYCONG, PHUCAP, TONGLUONG) ON LUONG TO QUAN_LY_TAI_VU;
GRANT INSERT, UPDATE(DONGIA) ON THUOC TO QUAN_LY_TAI_VU;
GRANT INSERT, UPDATE(DONGIA) ON DICHVU TO QUAN_LY_TAI_VU;
/

SELECT   'GRANT SELECT ON DBA_BV01.' || TABLE_NAME || ' to QUAN_LY_CHUYEN_MON;'
FROM     DBA_TABLES WHERE OWNER = 'DBA_BV01';
/

CREATE ROLE QUAN_LY_CHUYEN_MON;
GRANT SELECT ON DBA_BV01.BENHNHAN TO QUAN_LY_CHUYEN_MON;
GRANT SELECT ON DBA_BV01.CHAMCONG TO QUAN_LY_CHUYEN_MON;
GRANT SELECT ON DBA_BV01.CHITIETDICHVUHD TO QUAN_LY_CHUYEN_MON;
GRANT SELECT ON DBA_BV01.CHITIETTHUOCHD TO QUAN_LY_CHUYEN_MON;
GRANT SELECT ON DBA_BV01.DICHVU TO QUAN_LY_CHUYEN_MON;
GRANT SELECT ON DBA_BV01.LUONG TO QUAN_LY_CHUYEN_MON;
GRANT SELECT ON DBA_BV01.LICHTRUC TO QUAN_LY_CHUYEN_MON;
GRANT SELECT ON DBA_BV01.NHANVIEN TO QUAN_LY_CHUYEN_MON;
GRANT SELECT ON DBA_BV01.PHONG TO QUAN_LY_CHUYEN_MON;
GRANT SELECT ON DBA_BV01.PHONGBAN TO QUAN_LY_CHUYEN_MON;
GRANT SELECT ON DBA_BV01.THONGTINKHAMBENH TO QUAN_LY_CHUYEN_MON;
GRANT SELECT ON DBA_BV01.THUOC TO QUAN_LY_CHUYEN_MON;
GRANT SELECT ON DBA_BV01.CUOCHOP TO QUAN_LY_CHUYEN_MON;

/

CREATE ROLE TIEP_TAN;
GRANT SELECT, INSERT, DELETE, UPDATE ON BENHNHAN TO TIEP_TAN;
GRANT INSERT, SELECT, UPDATE ON THONGTINKHAMBENH TO TIEP_TAN;
GRANT INSERT, SELECT, UPDATE ON CUOCHOP TO TIEP_TAN;

/

CREATE ROLE TAI_VU;
GRANT SELECT ON THONGTINKHAMBENH TO TAI_VU;
GRANT SELECT ON CHITIETDICHVUHD TO TAI_VU;
GRANT UPDATE(THANHTIEN) ON CHITIETDICHVUHD TO TAI_VU;
GRANT INSERT, SELECT, UPDATE ON CUOCHOP TO TAI_VU;

/

CREATE ROLE BAC_SI;
GRANT SELECT, UPDATE(TRIEUCHUNG, LOIDAN) ON THONGTINKHAMBENH TO BAC_SI;
GRANT SELECT, UPDATE(SOLUONG, CACHDUNG), INSERT ON CHITIETTHUOCHD TO BAC_SI;
GRANT SELECT, UPDATE, INSERT ON CHITIETDICHVUHD TO BAC_SI;
GRANT INSERT, SELECT, UPDATE ON CUOCHOP TO BAC_SI;
/

CREATE ROLE BAN_THUOC;
GRANT SELECT ON CHITIETTHUOCHD TO BAN_THUOC;
GRANT INSERT, SELECT, UPDATE ON CUOCHOP TO BAN_THUOC;
/

CREATE ROLE KE_TOAN;
GRANT SELECT ON NHANVIEN TO KE_TOAN;
GRANT SELECT, INSERT, DELETE, UPDATE ON LUONG TO KE_TOAN;
GRANT INSERT, SELECT, UPDATE ON CUOCHOP TO KE_TOAN;
/

BEGIN
	--1TV,1KT,2TT,2BS,1BT
    EXECUTE IMMEDIATE 'DROP USER QLTN CASCADE';
    EXECUTE IMMEDIATE 'DROP USER QLCM CASCADE';
    EXECUTE IMMEDIATE 'DROP USER QLTV CASCADE';

	EXECUTE IMMEDIATE 'DROP USER TT001 CASCADE';
	EXECUTE IMMEDIATE 'DROP USER TT002 CASCADE';

    EXECUTE IMMEDIATE 'DROP USER BS001 CASCADE';
    EXECUTE IMMEDIATE 'DROP USER BS002 CASCADE';

    EXECUTE IMMEDIATE 'DROP USER KT001 CASCADE';

    EXECUTE IMMEDIATE 'DROP USER BT001 CASCADE';

    EXECUTE IMMEDIATE 'DROP USER TV001 CASCADE';
    EXCEPTION WHEN OTHERS THEN NULL; 
END;
/

CREATE USER QLTN IDENTIFIED BY 1;
GRANT CREATE SESSION TO QLTN;
GRANT QUAN_LY_TAI_NGUYEN TO QLTN;
/

CREATE USER QLCM IDENTIFIED BY 1;
GRANT CREATE SESSION TO QLCM;
GRANT QUAN_LY_CHUYEN_MON TO QLCM;
/

CREATE USER QLTV IDENTIFIED BY 1;
GRANT CREATE SESSION TO QLTV;
GRANT QUAN_LY_TAI_VU TO QLTV;
/

-- TIEP TAN
CREATE USER TT001 IDENTIFIED BY 1;
GRANT CREATE SESSION TO TT001;
GRANT TIEP_TAN TO TT001;
/

CREATE USER TT002 IDENTIFIED BY 1;
GRANT CREATE SESSION TO TT002;
GRANT TIEP_TAN TO TT002;
/

-- BAC SI
CREATE USER BS001 IDENTIFIED BY 1;
GRANT CREATE SESSION TO BS001;
GRANT BAC_SI TO BS001;
/

CREATE USER BS002 IDENTIFIED BY 1;
GRANT CREATE SESSION TO BS002;
GRANT BAC_SI TO BS002;
/

-- KE TOAN
CREATE USER KT001 IDENTIFIED BY 1;
GRANT CREATE SESSION TO KT001;
GRANT KE_TOAN TO KT001;
/

-- TAI VU
CREATE USER TV001 IDENTIFIED BY 1;
GRANT CREATE SESSION TO TV001;
GRANT TAI_VU TO TV001;
/

-- BAN THUOC
CREATE USER BT001 IDENTIFIED BY 1;
GRANT CREATE SESSION TO BT001;
GRANT BAN_THUOC TO BT001;
/

/*==============================================================*/
/* 								VPD     					    */
/*==============================================================*/

/*ADD VPD FUNCTION VPD BAC SI*/
CREATE OR REPLACE FUNCTION DBA_BV01.VPD_BACSI (
    P_SCHEMA IN VARCHAR2,
    P_OBJ IN VARCHAR2)
    RETURN VARCHAR2
    AS
    CURR_USER VARCHAR2(50);
    PREFIX VARCHAR2(2);
    BEGIN
        CURR_USER := SYS_CONTEXT('USERENV', 'SESSION_USER');
        PREFIX := SUBSTR(CURR_USER, 1, 2);
        IF (PREFIX = 'BS') 
        THEN
            RETURN 'BACSI IN (SELECT MANV FROM NHANVIEN WHERE USERNAME = ' || CHR(39) || CURR_USER || CHR(39) || ')';
        ELSE 
            RETURN '';
        END IF;
    END;
/

/*ADD VPD POLICIES*/
BEGIN
DBMS_RLS.ADD_POLICY(
	OBJECT_SCHEMA => 'DBA_BV01',
    OBJECT_NAME => 'THONGTINKHAMBENH',
    POLICY_NAME => 'BS_POLICY',
    FUNCTION_SCHEMA => 'DBA_BV01',
    POLICY_FUNCTION => 'VPD_BACSI',
    STATEMENT_TYPES => 'select',
    UPDATE_CHECK => TRUE);
END;
/

/*==============================================================*/
/* 								OLS     					    */
/*==============================================================*/

ALTER USER LBACSYS ACCOUNT UNLOCK IDENTIFIED BY 1231;

CONN LBACSYS/1231;


BEGIN
    SA_SYSDBA.DROP_POLICY(POLICY_NAME => 'ACCESS_HOP', DROP_COLUMN => TRUE);

	EXCEPTION WHEN OTHERS THEN NULL; 
END;
/

EXECUTE SA_SYSDBA.CREATE_POLICY(POLICY_NAME => 'ACCESS_HOP', COLUMN_NAME => 'OLS_HOP_COLUMN');

-- QUYEN QUAN TRI OLS POLICY
GRANT ACCESS_HOP_DBA TO DBA_BV01;

-- Package dùng để tạo ra các thành phần của nhãn
GRANT EXECUTE ON SA_COMPONENTS TO DBA_BV01;

-- Package dùng để tạo các nhãn
GRANT EXECUTE ON SA_LABEL_ADMIN TO DBA_BV01;

-- Package dùng để gán chính sách cho các table/schema
GRANT EXECUTE ON SA_POLICY_ADMIN TO DBA_BV01;

-- Package dùng để gán các label cho user
GRANT EXECUTE ON SA_USER_ADMIN TO DBA_BV01;

-- DROP LEVEL
BEGIN
    SA_COMPONENTS.DROP_LEVEL(
        POLICY_NAME   => 'ACCESS_HOP',
        SHORT_NAME     => 'QL');

	EXCEPTION WHEN OTHERS THEN NULL; 
END;
/

BEGIN
    SA_COMPONENTS.DROP_LEVEL(
        POLICY_NAME   => 'ACCESS_HOP',
        SHORT_NAME     => 'NV');

    EXCEPTION WHEN OTHERS THEN NULL; 
END;
/

-- CREATE LEVEL
BEGIN
    SA_COMPONENTS.CREATE_LEVEL(
        POLICY_NAME   => 'ACCESS_HOP',
        LONG_NAME      => 'QUANLY',
        SHORT_NAME     => 'QL',
        LEVEL_NUM      => 9000);
END;
/

BEGIN
    SA_COMPONENTS.CREATE_LEVEL(
        POLICY_NAME   => 'ACCESS_HOP',
        LONG_NAME      => 'NHANVIEN',
        SHORT_NAME     => 'NV',
        LEVEL_NUM      => 2000);
END;
/

-- DROP COMPARTMENT

BEGIN
    SA_COMPONENTS.DROP_COMPARTMENT(
        POLICY_NAME   => 'ACCESS_HOP',
        SHORT_NAME     => 'HQL');

    EXCEPTION WHEN OTHERS THEN NULL; 
END;
/

BEGIN
    SA_COMPONENTS.DROP_COMPARTMENT(
        POLICY_NAME   => 'ACCESS_HOP',
        SHORT_NAME     => 'HBS');

    EXCEPTION WHEN OTHERS THEN NULL; 
END;
/

BEGIN
    SA_COMPONENTS.DROP_COMPARTMENT(
        POLICY_NAME   => 'ACCESS_HOP',
        SHORT_NAME     => 'HTV');

    EXCEPTION WHEN OTHERS THEN NULL; 
END;
/

BEGIN
    SA_COMPONENTS.DROP_COMPARTMENT(
        POLICY_NAME   => 'ACCESS_HOP',
        SHORT_NAME     => 'HKT');

    EXCEPTION WHEN OTHERS THEN NULL; 
END;
/

BEGIN
    SA_COMPONENTS.DROP_COMPARTMENT(
        POLICY_NAME   => 'ACCESS_HOP',
        SHORT_NAME     => 'HTT');

    EXCEPTION WHEN OTHERS THEN NULL; 
END;
/

BEGIN
    SA_COMPONENTS.DROP_COMPARTMENT(
        POLICY_NAME   => 'ACCESS_HOP',
        SHORT_NAME     => 'HBT');

    EXCEPTION WHEN OTHERS THEN NULL; 
END;
/

-- CREATE COMPARTMENT

BEGIN
    SA_COMPONENTS.CREATE_COMPARTMENT(
    	POLICY_NAME   => 'ACCESS_HOP',
		LONG_NAME      => 'HOP_QUANLY',
		SHORT_NAME     => 'HQL',
		COMP_NUM       => 1000);
END;
/

BEGIN
    SA_COMPONENTS.CREATE_COMPARTMENT(
    	POLICY_NAME   => 'ACCESS_HOP',
		LONG_NAME      => 'HOP_BACSI',
		SHORT_NAME     => 'HBS',
		COMP_NUM       => 2000);
END;
/

BEGIN
    SA_COMPONENTS.CREATE_COMPARTMENT(
    	POLICY_NAME   => 'ACCESS_HOP',
		LONG_NAME      => 'HOP_TAIVU',
		SHORT_NAME     => 'HTV',
		COMP_NUM       => 3000);
END;
/

BEGIN
    SA_COMPONENTS.CREATE_COMPARTMENT(
    	POLICY_NAME   => 'ACCESS_HOP',
		LONG_NAME      => 'HOP_KETOAN',
		SHORT_NAME     => 'HKT',
		COMP_NUM       => 4000);
END;
/

BEGIN
    SA_COMPONENTS.CREATE_COMPARTMENT(
    	POLICY_NAME   => 'ACCESS_HOP',
		LONG_NAME      => 'HOP_BANTHUOC',
		SHORT_NAME     => 'HBT',
		COMP_NUM       => 5000);
END;
/

BEGIN
    SA_COMPONENTS.CREATE_COMPARTMENT(
    	POLICY_NAME   => 'ACCESS_HOP',
		LONG_NAME      => 'HOP_TIEPTAN',
		SHORT_NAME     => 'HTT',
		COMP_NUM       => 6000);
END;
/

-- DROP GROUP

BEGIN
    SA_COMPONENTS.DROP_GROUP(
        POLICY_NAME   => 'ACCESS_HOP',
        SHORT_NAME     => 'SG');

    EXCEPTION WHEN OTHERS THEN NULL; 
END;
/

BEGIN
    SA_COMPONENTS.DROP_GROUP(
        POLICY_NAME   => 'ACCESS_HOP',
        SHORT_NAME     => 'HN');

    EXCEPTION WHEN OTHERS THEN NULL; 
END;
/

-- CREATE GROUP

BEGIN  
	SA_COMPONENTS.CREATE_GROUP(
		POLICY_NAME   => 'ACCESS_HOP',
		LONG_NAME      => 'SAI_GON',
		SHORT_NAME     => 'SG',
		GROUP_NUM      => 51,
		PARENT_NAME    => NULL);
END;
/

BEGIN  
	SA_COMPONENTS.CREATE_GROUP(
		POLICY_NAME   => 'ACCESS_HOP',
		LONG_NAME      => 'HA_NOI',
		SHORT_NAME     => 'HN',
		GROUP_NUM      => 29,
		PARENT_NAME    => NULL);
END;
/

-- DROP LABEL

BEGIN		
	SA_LABEL_ADMIN.DROP_LABEL(
		POLICY_NAME   => 'ACCESS_HOP',
		LABEL_TAG      => 10000);

	EXCEPTION WHEN OTHERS THEN NULL; 
END;
/

BEGIN		
	SA_LABEL_ADMIN.DROP_LABEL(
		POLICY_NAME   => 'ACCESS_HOP',
		LABEL_TAG      => 40000);

	EXCEPTION WHEN OTHERS THEN NULL; 
END;
/

BEGIN		
	SA_LABEL_ADMIN.DROP_LABEL(
		POLICY_NAME   => 'ACCESS_HOP',
		LABEL_TAG      => 10051);

	EXCEPTION WHEN OTHERS THEN NULL;
END;
/

BEGIN		
	SA_LABEL_ADMIN.DROP_LABEL(
		POLICY_NAME   => 'ACCESS_HOP',
		LABEL_TAG      => 10029);

	EXCEPTION WHEN OTHERS THEN NULL;
END;
/

BEGIN		
	SA_LABEL_ADMIN.DROP_LABEL(
		POLICY_NAME   => 'ACCESS_HOP',
		LABEL_TAG      => 40051);

	EXCEPTION WHEN OTHERS THEN NULL;
END;
/

BEGIN		
	SA_LABEL_ADMIN.DROP_LABEL(
		POLICY_NAME   => 'ACCESS_HOP',
		LABEL_TAG      => 40029);

	EXCEPTION WHEN OTHERS THEN NULL;
END;
/

-- CREATE LABEL

BEGIN		
	SA_LABEL_ADMIN.CREATE_LABEL(
		POLICY_NAME   => 'ACCESS_HOP',
		LABEL_TAG      => 10000,
		LABEL_VALUE    => 'NV');
END;
/

BEGIN		
	SA_LABEL_ADMIN.CREATE_LABEL(
		POLICY_NAME   => 'ACCESS_HOP',
		LABEL_TAG      => 40000,
		LABEL_VALUE    => 'QL');
END;
/

BEGIN		
	SA_LABEL_ADMIN.CREATE_LABEL(
		POLICY_NAME   => 'ACCESS_HOP',
		LABEL_TAG      => 10051,
		LABEL_VALUE    => 'NV::SG');
END;
/

BEGIN		
	SA_LABEL_ADMIN.CREATE_LABEL(
		POLICY_NAME   => 'ACCESS_HOP',
		LABEL_TAG      => 10029,
		LABEL_VALUE    => 'NV::HN');
END;
/

BEGIN		
	SA_LABEL_ADMIN.CREATE_LABEL(
		POLICY_NAME   => 'ACCESS_HOP',
		LABEL_TAG      => 40051,
		LABEL_VALUE    => 'QL::SG');
END;
/

BEGIN		
	SA_LABEL_ADMIN.CREATE_LABEL(
		POLICY_NAME   => 'ACCESS_HOP',
		LABEL_TAG      => 40029,
		LABEL_VALUE    => 'QL::HN');
END;
/

-- LEVEL CUA ROLE

BEGIN
	sa_user_admin.set_levels(
		policy_name => 'ACCESS_HOP',
		user_name    => 'QUAN_LY_TAI_NGUYEN',
		max_level    => 'QL',
		min_level    => 'NV',
		def_level    => 'QL',
		row_level    => 'QL');
END;
/

BEGIN
	sa_user_admin.set_levels(
		policy_name => 'ACCESS_HOP',
		user_name    => 'QUAN_LY_CHUYEN_MON',
		max_level    => 'QL',
		min_level    => 'NV',
		def_level    => 'QL',
		row_level    => 'QL');
END;
/

BEGIN
	sa_user_admin.set_levels(
		policy_name => 'ACCESS_HOP',
		user_name    => 'QUAN_LY_TAI_VU',
		max_level    => 'QL',
		min_level    => 'NV',
		def_level    => 'QL',
		row_level    => 'QL');
END;
/

BEGIN
	sa_user_admin.set_levels(
		policy_name => 'ACCESS_HOP',
		user_name    => 'BAC_SI',
		max_level    => 'NV',
		min_level    => 'NV',
		def_level    => 'NV',
		row_level    => 'NV');
END;
/

BEGIN
	sa_user_admin.set_levels(
		policy_name => 'ACCESS_HOP',
		user_name    => 'TAI_VU',
		max_level    => 'NV',
		min_level    => 'NV',
		def_level    => 'NV',
		row_level    => 'NV');
END;
/

BEGIN
	sa_user_admin.set_levels(
		policy_name => 'ACCESS_HOP',
		user_name    => 'TIEP_TAN',
		max_level    => 'NV',
		min_level    => 'NV',
		def_level    => 'NV',
		row_level    => 'NV');
END;
/

BEGIN
	sa_user_admin.set_levels(
		policy_name => 'ACCESS_HOP',
		user_name    => 'BAN_THUOC',
		max_level    => 'NV',
		min_level    => 'NV',
		def_level    => 'NV',
		row_level    => 'NV');
END;
/

BEGIN
	sa_user_admin.set_levels(
		policy_name => 'ACCESS_HOP',
		user_name    => 'KE_TOAN',
		max_level    => 'NV',
		min_level    => 'NV',
		def_level    => 'NV',
		row_level    => 'NV');
END;
/

-- COMPARTMENT CUA ROLE

BEGIN
	sa_user_admin.set_compartments(
		policy_name => 'ACCESS_HOP',
		user_name    => 'QUAN_LY_TAI_NGUYEN',
		read_comps   => 'HQL, HBS, HTT, HTV, HBT, HKT',
		write_comps  => 'HQL, HBS, HTT, HTV, HBT, HKT',
		def_comps    => 'HQL',
		row_comps    => 'HQL');
END;
/

BEGIN
	sa_user_admin.set_compartments(
		policy_name => 'ACCESS_HOP',
		user_name    => 'QUAN_LY_CHUYEN_MON',
		read_comps   => 'HQL, HBS, HTT, HTV, HBT, HKT',
		write_comps  => 'HQL, HBS, HTT, HTV, HBT, HKT',
		def_comps    => 'HQL',
		row_comps    => 'HQL');
END;
/

BEGIN
	sa_user_admin.set_compartments(
		policy_name => 'ACCESS_HOP',
		user_name    => 'QUAN_LY_TAI_VU',
		read_comps   => 'HQL, HBS, HTT, HTV, HBT, HKT',
		write_comps  => 'HQL, HBS, HTT, HTV, HBT, HKT',
		def_comps    => 'HQL',
		row_comps    => 'HQL');
END;
/

BEGIN
	sa_user_admin.set_compartments(
		policy_name => 'ACCESS_HOP',
		user_name    => 'BAC_SI',
		read_comps   => 'HBS',
		write_comps  => 'HBS',
		def_comps    => 'HBS',
		row_comps    => 'HBS');
END;
/

BEGIN
	sa_user_admin.set_compartments(
		policy_name => 'ACCESS_HOP',
		user_name    => 'TAI_VU',
		read_comps   => 'HTV',
		write_comps  => 'HTV',
		def_comps    => 'HTV',
		row_comps    => 'HTV');
END;
/

BEGIN
	sa_user_admin.set_compartments(
		policy_name => 'ACCESS_HOP',
		user_name    => 'TIEP_TAN',
		read_comps   => 'HTT',
		write_comps  => 'HTT',
		def_comps    => 'HTT',
		row_comps    => 'HTT');
END;
/

BEGIN
	sa_user_admin.set_compartments(
		policy_name => 'ACCESS_HOP',
		user_name    => 'BAN_THUOC',
		read_comps   => 'HBT',
		write_comps  => 'HBT',
		def_comps    => 'HBT',
		row_comps    => 'HBT');
END;
/

BEGIN
	sa_user_admin.set_compartments(
		policy_name => 'ACCESS_HOP',
		user_name    => 'KE_TOAN',
		read_comps   => 'HKT',
		write_comps  => 'HKT',
		def_comps    => 'HKT',
		row_comps    => 'HKT');
END;
/

-- SET GROUPS

BEGIN
	sa_user_admin.set_groups(
		policy_name => 'ACCESS_HOP',
		user_name    => 'QUAN_LY_TAI_NGUYEN',
		read_groups  => 'UK,CA',
		write_groups => 'UK',
		def_groups   => 'UK',
		row_groups   => 'UK');
END;
/


--- DROP TABLE POLICY
BEGIN
    SA_POLICY_ADMIN.REMOVE_TABLE_POLICY
    (
        policy_name  => 'ACCESS_HOP',
        schema_name => 'DBA_USER',
        table_name => 'CUOC_HOP',
        drop_column => TRUE
    );
    EXCEPTION WHEN OTHERS THEN NULL;
END;
/

-----------------------------

BEGIN
    SA_POLICY_ADMIN.APPLY_TABLE_POLICY
    (
        policy_name  => 'ACCESS_HOP',
        schema_name => 'DBA_USER',
        table_name => 'CUOC_HOP',
        table_options => 'NO_CONTROL'
    );
END;
/